{"remainingRequest":"C:\\Users\\CAMILLE\\Downloads\\Tetard_App_ISBN\\BNF-Scan\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\CAMILLE\\Downloads\\Tetard_App_ISBN\\BNF-Scan\\src\\classes\\sparql.js","dependencies":[{"path":"C:\\Users\\CAMILLE\\Downloads\\Tetard_App_ISBN\\BNF-Scan\\src\\classes\\sparql.js","mtime":1576506452252},{"path":"C:\\Users\\CAMILLE\\Downloads\\Tetard_App_ISBN\\BNF-Scan\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\CAMILLE\\Downloads\\Tetard_App_ISBN\\BNF-Scan\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzpcXFVzZXJzXFxDQU1JTExFXFxEb3dubG9hZHNcXFRldGFyZF9BcHBfSVNCTlxcQk5GLVNjYW5cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lLWNvcmVqczMvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6XFxVc2Vyc1xcQ0FNSUxMRVxcRG93bmxvYWRzXFxUZXRhcmRfQXBwX0lTQk5cXEJORi1TY2FuXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS1jb3JlanMzL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKCnZhciBTcGFycWwgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBTcGFycWwoZW5kcG9pbnQpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTcGFycWwpOwoKICAgIC8vU3RvY2thZ2UgZGUgbCdVUkwgZHUgZW5kcG9pbnQKICAgIHRoaXMuZW5kcG9pbnQgPSBlbmRwb2ludDsKICB9CgogIF9jcmVhdGVDbGFzcyhTcGFycWwsIFt7CiAgICBrZXk6ICJxdWVyeSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcXVlcnkoX3F1ZXJ5KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0Nyw6lhdGlvbiBkJ3VuIHByb21pc2UgcXVpIHNlcmEgcsOpc29sdSBwbHVzIHRhcmQuLi4KICAgICAgdmFyIHF1ZXJ5UHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAvL1VuIG5vdXZlbCBvYmpldCByZXF1ZXRlIDogb24gdXRpbGlzZSBsYSBjbG9zdXJlIHBvdXIgbCd1dGlsaXNlciBwbHVzIHRhcmQuLi4KICAgICAgICB2YXIgaHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOyAvL1N1ciBjaGFuZ2VtZW50IGRlIHN0YXV0IGRlIGxhIHJlcXXDqnRlCgogICAgICAgIGh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIC8vU2kgYydlc3QgZmluaQogICAgICAgICAgaWYgKGh0dHAucmVhZHlTdGF0ZSA9PT0gWE1MSHR0cFJlcXVlc3QuRE9ORSkgewogICAgICAgICAgICAvL1NpIGMnZXN0IE9LCiAgICAgICAgICAgIGlmIChodHRwLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgLy9PbiByw6ljdXDDqHJlIGxhIHLDqXBvbnNlCiAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gaHR0cC5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy9TaSBwYXMgT0sgOiBmYWxzZQogICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IGZhbHNlOwogICAgICAgICAgICB9IC8vU2lub24gbnVsbCA9IGxhIHJlcXXDqnRlIG4nZXN0IHBhcyBmaW5pZQoKICAgICAgICAgIH0gZWxzZSB2YXIgcmVzcG9uc2UgPSBudWxsOyAvL1NpIGxhIHLDqXBvbnNlIGVzdCBmYWxzZSwgb24gcmVqZXR0ZQoKCiAgICAgICAgICBpZiAocmVzcG9uc2UgPT09IGZhbHNlKSByZWplY3QoaHR0cC5zdGF0dXMpOyAvL1NpIGMnZXN0IHBhcyBudWwsIG9uIGEgZXUgbGEgcsOpcG9uc2UKICAgICAgICAgIGVsc2UgaWYgKHJlc3BvbnNlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIC8vT24gcGFyc2UgbGUganNvbiByZW52b3nDqQogICAgICAgICAgICAgICAgdmFyIGpzb25SZXNwb25zZSA9IEpTT04ucGFyc2UocmVzcG9uc2UpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIC8vTGUganNvbiBuJ2VzdCBwYXMgY29ycmVjdCwgb24gcmVqZXR0ZQogICAgICAgICAgICAgICAgcmVqZWN0KCJDYW4ndCBwYXJzZSByZXNwb25zZSAhIik7CiAgICAgICAgICAgICAgfSAvL09uIHLDqXNvdWQgYXZlYyBsZSByw6lzdWx0YXQgcGFyc8OpICEKCgogICAgICAgICAgICAgIHJlc29sdmUoanNvblJlc3BvbnNlKTsKICAgICAgICAgICAgfQogICAgICAgIH07IC8vT3V2ZXJ0dXJlIGQndW5lIHJlcXXDqnRlIFBPU1QKCgogICAgICAgIGh0dHAub3BlbignUE9TVCcsIF90aGlzLmVuZHBvaW50KTsgLy9PbiBwb3N0ZSBsZXMgZG9ubsOpZXMgZW4gZm9ybXVsYWlyZSBlbmNvZMOpCgogICAgICAgIGh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOyAvL09uIGVudm9pZSBsZXMgcGFyYW3DqHRyZXMgcXVlcnksIGZvcm1hdCBhcHBsaWNhdGlvbi9zcGFycWwtcmVzdWx0cytqc29uIGV0IGwnYWRyZXNzZSBkdSBlbmRwb2ludCBhdSBwcm94eSBwaHAKCiAgICAgICAgaHR0cC5zZW5kKCJxdWVyeT0iICsgZW5jb2RlVVJJQ29tcG9uZW50KF9xdWVyeSkgKyAiJmZvcm1hdD0iICsgZW5jb2RlVVJJQ29tcG9uZW50KCJhcHBsaWNhdGlvbi9zcGFycWwtcmVzdWx0cytqc29uIikpOwogICAgICB9KTsgLy9PbiByZXZvaWUgbGUgcHJvbWlzZQoKICAgICAgcmV0dXJuIHF1ZXJ5UHJvbWlzZTsKICAgIH0KICB9XSk7CgogIHJldHVybiBTcGFycWw7Cn0oKTsKCmV4cG9ydCB7IFNwYXJxbCBhcyBkZWZhdWx0IH07"},{"version":3,"sources":["C:/Users/CAMILLE/Downloads/Tetard_App_ISBN/BNF-Scan/src/classes/sparql.js"],"names":["Sparql","endpoint","query","queryPromise","Promise","resolve","reject","http","XMLHttpRequest","onreadystatechange","e","readyState","DONE","status","response","responseText","jsonResponse","JSON","parse","open","setRequestHeader","send","encodeURIComponent"],"mappings":";;;;IAAqBA,M;;;AACjB,kBAAYC,QAAZ,EAAsB;AAAA;;AAClB;AACA,SAAKA,QAAL,GAAcA,QAAd;AACH;;;;0BAEKC,M,EAAO;AAAA;;AACT;AACA,UAAIC,YAAY,GAAC,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAASC,MAAT,EAAkB;AACvC;AACA,YAAIC,IAAI,GAAC,IAAIC,cAAJ,EAAT,CAFuC,CAGvC;;AACAD,QAAAA,IAAI,CAACE,kBAAL,GAAwB,UAACC,CAAD,EAAK;AACzB;AACA,cAAIH,IAAI,CAACI,UAAL,KAAoBH,cAAc,CAACI,IAAvC,EAA6C;AACzC;AACA,gBAAIL,IAAI,CAACM,MAAL,KAAgB,GAApB,EAAyB;AACrB;AACA,kBAAIC,QAAQ,GAACP,IAAI,CAACQ,YAAlB;AACH,aAHD,MAGO;AACH;AACA,kBAAID,QAAQ,GAAC,KAAb;AACH,aARwC,CASzC;;AACH,WAVD,MAUO,IAAIA,QAAQ,GAAC,IAAb,CAZkB,CAazB;;;AACA,cAAIA,QAAQ,KAAG,KAAf,EAAsBR,MAAM,CAACC,IAAI,CAACM,MAAN,CAAN,CAAtB,CACA;AADA,eAEK,IAAIC,QAAQ,KAAG,IAAf,EAAqB;AACtB,kBAAI;AACA;AACA,oBAAIE,YAAY,GAACC,IAAI,CAACC,KAAL,CAAWJ,QAAX,CAAjB;AACH,eAHD,CAGE,OAAMJ,CAAN,EAAS;AACP;AACAJ,gBAAAA,MAAM,CAAC,wBAAD,CAAN;AACH,eAPqB,CAQtB;;;AACAD,cAAAA,OAAO,CAACW,YAAD,CAAP;AACH;AACJ,SA3BD,CAJuC,CAgCvC;;;AACAT,QAAAA,IAAI,CAACY,IAAL,CAAU,MAAV,EAAiB,KAAI,CAAClB,QAAtB,EAjCuC,CAkCvC;;AACAM,QAAAA,IAAI,CAACa,gBAAL,CAAsB,cAAtB,EAAsC,mCAAtC,EAnCuC,CAoCvC;;AACAb,QAAAA,IAAI,CAACc,IAAL,CAAU,WAASC,kBAAkB,CAACpB,MAAD,CAA3B,GAAmC,UAAnC,GAA8CoB,kBAAkB,CAAC,iCAAD,CAA1E;AACH,OAtCY,CAAjB,CAFS,CAyCT;;AACA,aAAOnB,YAAP;AACH;;;;;;SAjDgBH,M","sourcesContent":["export default class Sparql {\n    constructor(endpoint) {\n        //Stockage de l'URL du endpoint\n        this.endpoint=endpoint;\n    }\n    \n    query(query) {\n        //Création d'un promise qui sera résolu plus tard...\n        let queryPromise=new Promise((resolve,reject)=>{\n                //Un nouvel objet requete : on utilise la closure pour l'utiliser plus tard...\n                let http=new XMLHttpRequest();\n                //Sur changement de staut de la requête\n                http.onreadystatechange=(e)=>{\n                    //Si c'est fini\n                    if (http.readyState === XMLHttpRequest.DONE) {\n                        //Si c'est OK\n                        if (http.status === 200) {\n                            //On récupère la réponse\n                            var response=http.responseText;\n                        } else {\n                            //Si pas OK : false\n                            var response=false;\n                        }\n                        //Sinon null = la requête n'est pas finie\n                    } else var response=null;\n                    //Si la réponse est false, on rejette\n                    if (response===false) reject(http.status);\n                    //Si c'est pas nul, on a eu la réponse\n                    else if (response!==null) {\n                        try {\n                            //On parse le json renvoyé\n                            var jsonResponse=JSON.parse(response);\n                        } catch(e) {\n                            //Le json n'est pas correct, on rejette\n                            reject(\"Can't parse response !\");\n                        }\n                        //On résoud avec le résultat parsé !\n                        resolve(jsonResponse);\n                    }\n                }\n                //Ouverture d'une requête POST\n                http.open('POST',this.endpoint);\n                //On poste les données en formulaire encodé\n                http.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n                //On envoie les paramètres query, format application/sparql-results+json et l'adresse du endpoint au proxy php\n                http.send(\"query=\"+encodeURIComponent(query)+\"&format=\"+encodeURIComponent(\"application/sparql-results+json\"));\n            });\n        //On revoie le promise\n        return queryPromise;\n    }\n}\n\n"]}]}